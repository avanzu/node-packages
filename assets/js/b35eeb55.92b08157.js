"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[67],{7047:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"kernel/kernel/message-bus","title":"Message Bus Integration","description":"The kernel provides optional integration with an internal message bus. This enables decoupled communication between container modules through event publishing and subscription.","source":"@site/docs/kernel/2000-kernel/2000-message-bus.md","sourceDirName":"kernel/2000-kernel","slug":"/kernel/kernel/message-bus","permalink":"/node-packages/docs/kernel/kernel/message-bus","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2000,"frontMatter":{"title":"Message Bus Integration","sidebar_label":"Message Bus Integration"},"sidebar":"kernelSidebar","previous":{"title":"Middleware","permalink":"/node-packages/docs/kernel/kernel/middleware"},"next":{"title":"Minimal","permalink":"/node-packages/docs/kernel/guides/scaffolding/minimal"}}');var i=s(4848),r=s(8453);const a={title:"Message Bus Integration",sidebar_label:"Message Bus Integration"},o=void 0,l={},d=[{value:"EventHandlerSpec",id:"eventhandlerspec",level:2},{value:"Usage in a Container Module",id:"usage-in-a-container-module",level:2},{value:"Customizing the Bus",id:"customizing-the-bus",level:2},{value:"Summary",id:"summary",level:2}];function c(e){const n={code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The kernel provides optional integration with an internal message bus. This enables decoupled communication between container modules through event publishing and subscription."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"eventhandlerspec",children:"EventHandlerSpec"}),"\n",(0,i.jsxs)(n.p,{children:["Container modules that wish to react to specific events can implement the ",(0,i.jsx)(n.code,{children:"getEventHandlers()"})," method to return an array of ",(0,i.jsx)(n.code,{children:"EventHandlerSpec"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"type EventHandlerSpec = {\n  event: string\n  handler: (payload: any, context: any) => Promise<void> | void\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Each event handler is automatically registered to the bus if the message bus is available."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"usage-in-a-container-module",children:"Usage in a Container Module"}),"\n",(0,i.jsx)(n.p,{children:"You can opt into event handling by returning one or more handlers in your module:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"getEventHandlers(): EventHandlerSpec[] {\n  return [\n    {\n      event: 'user.registered',\n      handler: async (payload) => {\n        // handle the event\n      }\n    }\n  ]\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"If no message bus is installed, this method is simply ignored \u2014 making event handling optional and non-intrusive."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"customizing-the-bus",children:"Customizing the Bus"}),"\n",(0,i.jsxs)(n.p,{children:["The message bus is resolved from the container. To use a different implementation, bind your own under the ",(0,i.jsx)(n.code,{children:"messageBus"})," token in your container configuration."]}),"\n",(0,i.jsx)(n.p,{children:"Example using a stubbed bus:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"container.register({\n  messageBus: asValue({\n    publish: async () => {},  // noop\n    subscribe: () => {}       // noop\n  })\n})\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Event handling is optional and modular"}),"\n",(0,i.jsxs)(n.li,{children:["Modules declare interest via ",(0,i.jsx)(n.code,{children:"getEventHandlers()"})]}),"\n",(0,i.jsx)(n.li,{children:"No runtime error if no bus is present"}),"\n",(0,i.jsx)(n.li,{children:"Custom buses are supported via container registration"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);